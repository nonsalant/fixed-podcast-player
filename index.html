<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 36 36%22><text y=%2232%22 font-size=%2232%22>🎧</text></svg>">
    <title>Fixed Podcast Player Demo</title>
    <meta name="description" content="Web Component for an audio player and a Play button. The player is revealed when the button is scrolled into view.">
    <!-- Demo Styles -->
    <style> *, *:before, *:after { box-sizing: border-box; }
        :root { color-scheme: light dark; } body { padding: 1lh; background: light-dark(whitesmoke, #111); }
        main { max-width: 55rem; margin-inline: auto; font-family: system-ui; text-wrap: pretty; }
    </style>

    <!-- Podcast Player Assets (CSS, JS, SVG) -->
    <link rel="stylesheet" class="fpp" href="./assets/build/podcast-player.min.css">
    <script src="./assets/build/podcast-player.min.js" type="module"></script>
    <link rel="icon-sprite-sheet" class="fpp" href="./assets/icons.svg">

</head>
<body>
    
    <main>
        <h1>Fixed Podcast Player</h1>
        <p>
            <a href="https://github.com/nonsalant/fixed-podcast-player?tab=readme-ov-file#attributes-for-the-podcast-player-element">
            <strong>See the GitHub Readme</strong></a>
            for info on the Web Component's attributes and overriding the CSS variables.
        </p>
	    <h2>Web Component for a sticky audio player and its <em>Play</em> button</h2>
        <ul>
            <li>can be closed or moved to the top</li>
            <li>position, vloume, and playback speed are preserved in <code>localStorage</code></li>
            <li>styles are fully encapsulated using Declarative Shadow DOM</li>
        </ul>
        <p><b>Scroll down 👇</b></p>
    
        <!-- -->
        <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Laudantium explicabo voluptatem quos error itaque illum nihil, optio illo dicta maiores, deleniti nemo aperiam, doloribus nostrum quas reprehenderit exercitationem vitae esse.</p>
        <p>Atque voluptates optio eaque sed asperiores delectus corrupti voluptas architecto recusandae quis perspiciatis ratione dignissimos cum praesentium, placeat est ea pariatur. Odio aspernatur quas blanditiis quia repellendus voluptatem totam harum?</p>
        <p>Quas voluptatum beatae ullam nihil aspernatur debitis suscipit culpa sed molestias eius ipsum libero vitae incidunt consequatur architecto, fugit odio repudiandae rem? Libero, mollitia ipsam ducimus necessitatibus atque aliquam dicta.</p>
        <p>Quos quaerat, esse quo architecto atque quasi ut blanditiis inventore alias harum nobis provident, dolorum odio odit aliquid itaque doloremque perspiciatis numquam qui, quae eaque delectus fugit aperiam. Voluptate, quaerat.</p>
        <p>Eius amet, nulla, animi tenetur deleniti illum quod blanditiis iure repellat consectetur aperiam. Eligendi quos aperiam ex deleniti tenetur nulla molestiae magnam quasi fugit, voluptatem ut veritatis quia reiciendis mollitia!</p>
        <p>Ut quos commodi explicabo praesentium quaerat modi cumque facilis hic at quam sunt voluptatum ipsa corporis necessitatibus eius minus nostrum, aperiam atque nobis excepturi sapiente quae tenetur officiis dolorem? Illo.</p>
        <p>Iste atque tempora eligendi dicta commodi cum quis laboriosam aut culpa libero, debitis, doloremque laborum et excepturi mollitia optio tenetur nemo nulla quod! Ipsum repellat, provident earum beatae dolore assumenda.</p>
        <p>Adipisci culpa laudantium est nostrum reprehenderit quaerat, sed hic accusantium! Aliquam, ut! Aut a optio fugiat provident accusamus, illo quibusdam hic fuga cupiditate porro amet, error soluta, corrupti natus architecto!</p>
        <p>Temporibus possimus ipsa sit nihil sunt sint architecto placeat dolorum voluptates consequatur, dolore aperiam voluptatibus deserunt neque, aut eius laboriosam nulla et. Illum, facilis quasi omnis placeat quisquam necessitatibus quo.</p>
        <p>Cum dignissimos, modi explicabo repellat dolorum quam? Minima molestiae quae dolor doloribus asperiores non sint eum laudantium, fugit fuga vero provident commodi aliquam. Delectus, deserunt aliquid. Molestias ea repellat sapiente.</p>
        <p>Dolorum repellat eligendi praesentium quisquam dignissimos provident aliquid quis? Tenetur cumque quam dicta, exercitationem itaque odio! Consequuntur eligendi voluptatum inventore maiores aliquam cupiditate reiciendis quaerat atque similique, dignissimos nobis voluptatem.</p>
        <p>Sint vitae ipsa optio dolor nulla recusandae accusamus illum! Dolor in asperiores facere blanditiis obcaecati ad, laborum libero veritatis cupiditate pariatur delectus ducimus consectetur deleniti nostrum temporibus voluptatum beatae minus.</p>
        <p>Nostrum repudiandae at, recusandae neque voluptate explicabo saepe laudantium voluptatem aliquam excepturi blanditiis veniam atque quod iusto dolore debitis voluptates suscipit mollitia minus quidem obcaecati architecto facere. Nisi, laborum ab.</p>
        <!-- -->

        <!-- <podcast-player data-title="A closer look at ironweeds, or Vernonia, with Mt. Cuba&#39;s Sam Hoadley" data-src="https://robinhoodradioondemand.com/podcast-player/40848/ironweeds-with-sam-hoadley-a-way-to-garden-with-margaret-roach-feb-17-2025.mp3" data-thumb="https://awaytogarden.com/wp-content/uploads/2025/02/Fritillary-on-Vernonia-0A6A7837-1920x1012-1-240x180.jpg">
            <button class="show-and-play" type="button">Play</button>
        </podcast-player> -->

        <podcast-player data-title="A closer look at ironweeds, or Vernonia, with Mt. Cuba&#39;s Sam Hoadley" data-position="bottom" data-variation="floating" show-on="scroll" data-thumb="https://awaytogarden.com/wp-content/uploads/2025/02/Fritillary-on-Vernonia-0A6A7837-1920x1012-1-240x180.jpg">
            <a class="show-and-play" href="https://robinhoodradioondemand.com/podcast-player/40848/ironweeds-with-sam-hoadley-a-way-to-garden-with-margaret-roach-feb-17-2025.mp3">Play</a>
        </podcast-player>

        <!-- <podcast-player data-title="A closer look at ironweeds, or Vernonia, with Mt. Cuba&#39;s Sam Hoadley" data-thumb="https://awaytogarden.com/wp-content/uploads/2025/02/Fritillary-on-Vernonia-0A6A7837-1920x1012-1-240x180.jpg">
            <a class="show-and-play" href="https://robinhoodradioondemand.com/podcast-player/40848/ironweeds-with-sam-hoadley-a-way-to-garden-with-margaret-roach-feb-17-2025.mp3">
                <div icon-name="play-circle-solid">Play</div>
                <div icon-name="pause-circle">Pause</div>
                <div icon-name="play-circle">Resume</div>
            </a>
        </podcast-player> -->

        <style>
            fieldset {
                accent-color: var(--pp-color);
                display: grid;
                border-radius: 3px;
                gap: 1lh;
                margin-block: 1.5lh;
                padding: 1lh .5lh;
                legend { font-weight: bold; padding-inline: .25lh; }
                :is(h2, h3) { margin-block-end: 0; }
                code:has(pre) { overflow: auto; display: block; }
                & > label { 
                    display: grid;
                    gap: .5lh;
                    align-items: center; 
                    grid-template-columns: auto 1fr 5rem;
                    @media (width < 600px ) { grid-template-columns: 1fr; }
                }
            }
        </style>
        <fieldset id="options" onchange="console.log('changed')">
            <legend>🎨 Customize</legend>
            
            <color-picker>
                <style>
                    /* color picker styles */
                    label:has(>#color-picker[type=color]) {display:flex; gap:.5lh; ul {margin:0; padding-inline-start:1lh;} }
                    #color-picker[type=color] {border-radius:50%; inline-size:2em; block-size:2em; cursor: pointer; padding:0px; border-width:3px; border-style:solid; border-color:rgb(220,220,220);}
                    #color-picker[type=color]::-webkit-color-swatch-wrapper {padding:0px;}
                    #color-picker[type=color]::-webkit-color-swatch {border-radius:50%;}
                    #color-picker[type=color]::-moz-color-swatch {border-radius:50%;}
                </style>
                <label for="color-picker">
                    <span>Button color<br> (also the base color)</span>
                    <input type="color" value="#426c8a" id="color-picker">
                    <output>
                        <ul>
                            <li>hue: <code>205deg</code></li>
                            <li>saturation: <code>35%</code></li>
                            <li>lightnes: <code>40%</code></li>
                        </ul>
                    </output>
                </label>
            </color-picker>
            <script type="module">
                class ColorPicker extends HTMLElement {
                    constructor() {
                        super();
                        this.defaultColor = this.getAttribute("default-color") ?? "#426c8a"; // darkblue
                        this.propName = "--pp-color";
                        this.hue = "--pp-hue";
                        this.sat = "--pp-sat";
                        this.lig = "--pp-lig";
                    }

                    connectedCallback() {
                        this.picker = this.querySelector("input[type=color]");

                        const initialColor = getProp(this.propName);
                        this.picker.value = initialColor.startsWith("#")
                            ? initialColor
                            : this.defaultColor;

                        this.setColor();
                        this.picker.addEventListener("input", this.handleColorPicker.bind(this));
                    }

                    handleColorPicker() {
                        this.setColor();
                    }

                    setColor() {
                        setProp(this.propName, this.picker.value);
                        const hsl = hexToHsl(this.picker.value);
                        setProp(this.hue, hsl.h + "deg");
                        setProp(this.sat, hsl.s + "%");
                        setProp(this.lig, hsl.l + "%");
                        // console.log(hsl);
                        this.querySelector("output").innerHTML = `
                        <ul>
                            <li>hue: <code>${hsl.h}deg</code></li>
                            <li>saturation: <code>${hsl.s}%</code></li>
                            <li>lightnes: <code>${hsl.l}%</code></li>
                        </ul>
                        `;
                    }
                }

                customElements.define("color-picker", ColorPicker);

                function setProp(propName, propValue) {
                    document.documentElement.style.setProperty(propName, propValue);
                }

                function getProp(propName) {
                    return getComputedStyle(document.documentElement)
                        .getPropertyValue(propName)
                        .trim();
                }

                function hexToHsl(hex) {
                    // Remove '#' if present
                    hex = hex.replace(/^#/, "");

                    let r = parseInt(hex.substring(0, 2), 16) / 255;
                    let g = parseInt(hex.substring(2, 4), 16) / 255;
                    let b = parseInt(hex.substring(4, 6), 16) / 255;

                    let max = Math.max(r, g, b),
                        min = Math.min(r, g, b);
                    let h,
                        s,
                        l = (max + min) / 2;

                    if (max === min) {
                        h = s = 0; // Grayscale
                    } else {
                        let d = max - min;
                        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);

                        switch (max) {
                            case r:
                                h = (g - b) / d + (g < b ? 6 : 0);
                                break;
                            case g:
                                h = (b - r) / d + 2;
                                break;
                            case b:
                                h = (r - g) / d + 4;
                                break;
                        }

                        h = Math.round(h * 60);
                    }

                    return { h, s: Math.round(s * 100), l: Math.round(l * 100) };
                }

            </script>

            <label for="gradient-difference">
                <span>Hue difference in gradient<br> (for player background)</span>
                <input type="range" id="gradient-difference" min="0" max="360" step="1" value="15"
                oninput="document.documentElement.style.setProperty('--pp-gradient-hue-difference', this.value + 'deg');
                this.nextElementSibling.innerText = this.value + 'deg';">
                <code>15deg</code>
            </label>

            <label for="content-width">
                <span>Player maximum width<br> (on large screens)</span>
                <input type="range" id="content-width" min="200" max="2000" step="1" value="640"
                oninput="document.documentElement.style.setProperty('--pp-content-width', this.value + 'px');
                this.nextElementSibling.innerText = this.value + 'px';">
                <code>640px</code>
            </label>

            <label for="border-radius">
                <span>Player border radius</span>
                <input type="range" id="border-radius" min="0" max="50" step="1" value="24"
                oninput="document.documentElement.style.setProperty('--pp-radius', this.value + 'px');
                this.nextElementSibling.innerText = this.value + 'px';">
                <code>24px</code>
            </label>

            <section>
                <h3>CSS</h3>
                <code>
                    <pre>:root {
    --pp-hue: 205deg;
    --pp-sat: 35%;
    --pp-lig: 40%;
    --pp-gradient-hue-difference: 15deg;
    --pp-content-width: 640px;
}</pre>
                </code>
            </section>

        </fieldset>
        <fieldset id="codes">
            <legend>⚙️ Attributes</legend>

            <label for="variation">
                <span>Variation</span>
                <select id="variation" 
                    onchange="el = document.querySelector('podcast-player');
                    el.setAttribute('data-variation', this.value);
                    el.shadowRoot.querySelector('.podcast-player').setAttribute('data-variation', this.value);">
                    <option value="floating">Floating on large screens</option>
                    <option value="">Fixed to the bottom or top on all screens</option>
                </select>
            </label>

            <label for="variation">
                <span>Default position</span>
                <select id="variation" 
                    onchange="el = document.querySelector('podcast-player');
                    el.setAttribute('data-position', this.value);
                    el.shadowRoot.querySelector('.podcast-player').setAttribute('data-position', this.value);">
                    <option value="bottom">Bottom of screen</option>
                    <option value="top">Top of screen</option>
                </select>
            </label>

            <section>
                <h3>HTML</h3>
                <code>
                    <pre>&lt;podcast-player data-title="…" data-thumb="…" data-variation="floating"&gt;
    &lt;a class="show-and-play" href="…"&gt;Play&lt;/a&gt;
&lt;/podcast-player&gt;</pre>
                </code>
            </section>
        </fieldset>

        <p><a href="https://github.com/nonsalant/fixed-podcast-player/">View GitHub repo</a></p>
        <p><a href="https://codepen.io/nonsalant/pen/pvoyRmZ" target="_blank">View on CodePen</a></p>
    </main>
</body>
</html>